# æœåŠ¡å¥åº·ç›‘æ§ç³»ç»Ÿ - æ ‡å‡†é…ç½®ç¤ºä¾‹
# åŒ…å«å¸¸ç”¨æœåŠ¡ç±»å‹å’Œé…ç½®é€‰é¡¹çš„ç¤ºä¾‹

# ============================================================================
# å…¨å±€é…ç½®
# ============================================================================
global:
  check_interval: 30        # é»˜è®¤æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰
  log_level: INFO          # æ—¥å¿—çº§åˆ«: DEBUG, INFO, WARNING, ERROR, CRITICAL
  log_file: /var/log/health-monitor.log  # æ—¥å¿—æ–‡ä»¶è·¯å¾„
  log_max_size: 100        # æ—¥å¿—æ–‡ä»¶æœ€å¤§å¤§å°ï¼ˆMBï¼‰
  log_backup_count: 5      # ä¿ç•™çš„æ—¥å¿—æ–‡ä»¶æ•°é‡

# ============================================================================
# æœåŠ¡ç›‘æ§é…ç½®
# ============================================================================
services:
  # Redisç¼“å­˜æœåŠ¡
  redis-cache:
    type: redis
    host: localhost
    port: 6379
    password: "your_redis_password"  # Rediså¯†ç ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®å¯†ç å¯ä»¥æ³¨é‡Šæ‰
    database: 0                      # Redisæ•°æ®åº“ç¼–å·
    timeout: 5                       # è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    check_interval: 10               # æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰
    test_operations: false           # æ˜¯å¦æ‰§è¡ŒSET/GETæ“ä½œæµ‹è¯•
    collect_info: true               # æ˜¯å¦æ”¶é›†RedisæœåŠ¡å™¨ä¿¡æ¯

  # MySQLæ•°æ®åº“
  user-database:
    type: mysql
    host: localhost
    port: 3306
    username: monitor_user           # æ•°æ®åº“ç›‘æ§ç”¨æˆ·
    password: "db_password"          # æ•°æ®åº“å¯†ç 
    database: users                  # è¦è¿æ¥çš„æ•°æ®åº“å
    timeout: 10                      # è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    check_interval: 30               # æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰
    test_queries: false              # æ˜¯å¦æ‰§è¡Œæµ‹è¯•æŸ¥è¯¢
    collect_status: true             # æ˜¯å¦æ”¶é›†æ•°æ®åº“çŠ¶æ€ä¿¡æ¯

  # EMQXæ¶ˆæ¯ä»£ç†
  message-broker:
    type: emqx
    host: localhost
    port: 1883                       # MQTTç«¯å£
    username: mqtt_user              # MQTTç”¨æˆ·å
    password: "mqtt_password"        # MQTTå¯†ç 
    client_id: health_monitor        # MQTTå®¢æˆ·ç«¯ID
    timeout: 15                      # è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    check_interval: 20               # æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰
    check_method: mqtt               # æ£€æŸ¥æ–¹æ³•: mqtt æˆ– http
    test_pubsub: false               # æ˜¯å¦æµ‹è¯•å‘å¸ƒ/è®¢é˜…åŠŸèƒ½

  # RESTful APIæœåŠ¡
  user-api:
    type: restful
    url: https://api.example.com/health
    method: GET                      # HTTPæ–¹æ³•
    headers:
      Authorization: "Bearer your_api_token"
      Accept: "application/json"
    expected_status: 200             # æœŸæœ›çš„HTTPçŠ¶æ€ç 
    expected_content: "healthy"      # æœŸæœ›å“åº”å†…å®¹åŒ…å«çš„å­—ç¬¦ä¸²
    timeout: 10                      # è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    check_interval: 20               # æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰
    validate_json: true              # æ˜¯å¦éªŒè¯JSONæ ¼å¼

  # MongoDBæ–‡æ¡£æ•°æ®åº“
  document-store:
    type: mongodb
    host: localhost
    port: 27017
    username: mongo_user             # MongoDBç”¨æˆ·å
    password: "mongo_password"       # MongoDBå¯†ç 
    database: documents              # è¦è¿æ¥çš„æ•°æ®åº“å
    timeout: 10                      # è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    check_interval: 25               # æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰
    test_queries: false              # æ˜¯å¦æ‰§è¡Œæµ‹è¯•æŸ¥è¯¢
    collect_status: true             # æ˜¯å¦æ”¶é›†æœåŠ¡å™¨çŠ¶æ€ä¿¡æ¯

# ============================================================================
# å‘Šè­¦é…ç½®
# ============================================================================
alerts:
  # é’‰é’‰æœºå™¨äººå‘Šè­¦
  - name: dingtalk-robot
    type: http
    url: "https://oapi.dingtalk.com/robot/send?access_token=YOUR_DINGTALK_TOKEN"
    method: POST
    timeout: 10                      # å‘Šè­¦å‘é€è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    max_retries: 3                   # æœ€å¤§é‡è¯•æ¬¡æ•°
    retry_delay: 1.0                 # é‡è¯•å»¶è¿Ÿï¼ˆç§’ï¼‰
    retry_backoff: 2.0               # æŒ‡æ•°é€€é¿å€æ•°
    headers:
      Content-Type: "application/json"
    template: |
      {
        "msgtype": "text",
        "text": {
          "content": "ğŸš¨ æœåŠ¡å¥åº·å‘Šè­¦\n\næœåŠ¡åç§°: {{service_name}}\næœåŠ¡ç±»å‹: {{service_type}}\nå½“å‰çŠ¶æ€: {{status}}\nå‘ç”Ÿæ—¶é—´: {{timestamp}}\nå“åº”æ—¶é—´: {{response_time}}ms\né”™è¯¯ä¿¡æ¯: {{error_message}}\n\nè¯·åŠæ—¶å¤„ç†ï¼"
        }
      }

  # è‡ªå®šä¹‰Webhookå‘Šè­¦
  - name: webhook-alert
    type: http
    url: "https://your-webhook-endpoint.com/alerts"
    method: POST
    timeout: 15
    max_retries: 2
    retry_delay: 1.0
    retry_backoff: 1.5
    headers:
      Content-Type: "application/json"
      X-API-Key: "your-webhook-api-key"
      X-Source: "health-monitor"
    template: |
      {
        "alert_type": "service_health",
        "service": {
          "name": "{{service_name}}",
          "type": "{{service_type}}",
          "status": "{{status}}"
        },
        "timestamp": "{{timestamp}}",
        "response_time_ms": {{response_time}},
        "error_message": "{{error_message}}"
      }

# ============================================================================
# é…ç½®è¯´æ˜
# ============================================================================
# 
# 1. æœåŠ¡ç±»å‹è¯´æ˜ï¼š
#    - redis: Redisç¼“å­˜æœåŠ¡
#    - mysql: MySQLæ•°æ®åº“
#    - mongodb: MongoDBæ–‡æ¡£æ•°æ®åº“
#    - emqx: EMQX MQTTæ¶ˆæ¯ä»£ç†
#    - restful: RESTful HTTP APIæœåŠ¡
#
# 2. å…¨å±€é…ç½®è¯´æ˜ï¼š
#    - check_interval: é»˜è®¤æ£€æŸ¥é—´éš”ï¼Œå¦‚æœæœåŠ¡æ²¡æœ‰å•ç‹¬é…ç½®åˆ™ä½¿ç”¨æ­¤å€¼
#    - log_level: æ—¥å¿—çº§åˆ«ï¼Œå»ºè®®ç”Ÿäº§ç¯å¢ƒä½¿ç”¨INFOæˆ–WARNING
#    - log_file: æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼Œå¦‚æœä¸æŒ‡å®šåˆ™åªè¾“å‡ºåˆ°æ§åˆ¶å°
#
# 3. å‘Šè­¦æ¨¡æ¿å˜é‡ï¼š
#    - {{service_name}}: æœåŠ¡åç§°
#    - {{service_type}}: æœåŠ¡ç±»å‹
#    - {{status}}: æœåŠ¡çŠ¶æ€ (UP/DOWN)
#    - {{timestamp}}: æ—¶é—´æˆ³
#    - {{response_time}}: å“åº”æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
#    - {{error_message}}: é”™è¯¯ä¿¡æ¯
#    - {{metadata_json}}: å…ƒæ•°æ®JSONå­—ç¬¦ä¸²
#
# 4. å®‰å…¨å»ºè®®ï¼š
#    - å°†æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç ã€APIå¯†é’¥ï¼‰å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡ä¸­
#    - ä¸ºç›‘æ§åˆ›å»ºä¸“é—¨çš„æ•°æ®åº“ç”¨æˆ·ï¼Œåªæˆäºˆå¿…è¦æƒé™
#    - å®šæœŸè½®æ¢å¯†ç å’ŒAPIå¯†é’¥
